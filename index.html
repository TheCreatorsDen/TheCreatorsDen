<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Creator's Den Leaderboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Teko:wght@400;500;600;700&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        teko: ['Teko', 'sans-serif'],
                        poppins: ['Poppins', 'sans-serif'],
                    },
                    colors: {
                        brandBlue: '#00AEEF',
                        brandRed: '#ED1C24',
                        brandYellow: '#FFC20E',
                        brandGreen: '#00ff84', 
                        darkBase: '#0b0d17', 
                        cardSolid: '#15192b',
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'slide-in': 'slideIn 0.4s ease-out forwards',
                        'shine': 'shine 2s infinite linear',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-10px)' },
                        },
                        slideIn: {
                            '0%': { opacity: '0', transform: 'translateX(-10px)' },
                            '100%': { opacity: '1', transform: 'translateX(0)' },
                        },
                        shine: {
                            '0%': { backgroundPosition: '-200% center' },
                            '100%': { backgroundPosition: '200% center' }
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* --- VIEWPORT LOCK --- */
        body { 
            background-color: #0b0d17;
            color: white;
            cursor: default; 
            font-family: 'Poppins', sans-serif;
            overflow: hidden; 
            height: 100vh;
            height: 100dvh; 
            display: flex;
            flex-direction: column;
        }

        /* --- Scrollbar --- */
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-track { background: #0f111a; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        .custom-scroll::-webkit-scrollbar-thumb:hover { background: #00AEEF; }

        /* --- NEW SOLID PILL CARD --- */
        .pill-row {
            display: flex;
            align-items: center;
            width: 100%;
            background: #15192b;
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 9999px; /* Full Capsule */
            padding: 8px 16px 8px 8px; /* Right padding for points */
            gap: 12px;
            transition: transform 0.2s, background-color 0.2s;
        }

        .pill-row:hover {
            transform: scale(1.01);
            background: #1e2639;
            border-color: #00ff84;
            box-shadow: 0 4px 15px rgba(0, 255, 132, 0.1);
        }

        /* Shiny Medal Styles */
        .medal-gold {
            background: linear-gradient(135deg, #FFD700, #FDB931, #FFD700);
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
            border: 2px solid #fff;
            color: #5e4802;
        }
        .medal-silver {
            background: linear-gradient(135deg, #E0E0E0, #B0B0B0, #E0E0E0);
            box-shadow: 0 0 10px rgba(192, 192, 192, 0.5);
            border: 2px solid #fff;
            color: #333;
        }
        .medal-bronze {
            background: linear-gradient(135deg, #CD7F32, #A0522D, #CD7F32);
            box-shadow: 0 0 10px rgba(205, 127, 50, 0.5);
            border: 2px solid #fff;
            color: #3e1c0a;
        }
        .rank-default {
            background: #1e2330;
            border: 1px solid #334155;
            color: #94a3b8;
        }

        /* Modal Transitions */
        #profile-modal { transition: opacity 0.2s ease, visibility 0.2s ease; }
        #profile-modal.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
        #modal-content { transform: scale(0.95); transition: transform 0.2s ease; }
        #profile-modal:not(.hidden) #modal-content { transform: scale(1); }
    </style>
</head>
<body class="bg-[#0a0e17] bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-[#1a2035] via-[#0a0e17] to-[#0a0e17]">

    <canvas id="global-confetti-canvas" class="fixed top-0 left-0 w-full h-full pointer-events-none z-[50]"></canvas>
    <!-- Full Screen Winner Confetti Canvas -->
    <canvas id="winner-confetti-canvas" class="fixed top-0 left-0 w-full h-full pointer-events-none z-[10001] hidden"></canvas>

    <!-- Header -->
    <header class="w-full py-4 text-center z-10 shrink-0">
        <div class="flex flex-col items-center justify-center gap-2">
            <!-- BRAND LOGO AREA (Colored Text + Logo) -->
            <div class="flex items-center justify-center gap-3">
                <img src="logo.png" alt="TCD" class="h-10 w-auto object-contain drop-shadow-md" onerror="this.style.display='none'">
                
                <!-- Bolder, Larger, Brand Colored Text -->
                <div class="flex items-center gap-2 text-sm md:text-xl font-black tracking-[0.2em] uppercase drop-shadow-lg">
                    <span class="text-brandRed">THE</span>
                    <span class="text-brandBlue">CREATOR'S</span>
                    <span class="text-brandYellow">DEN</span>
                </div>
            </div>
            
            <div class="flex items-center justify-center gap-2 cursor-pointer group" onclick="fireGlobalConfetti()">
                <div class="bg-brandYellow/10 border border-brandYellow/30 px-5 py-1 rounded-full flex items-center gap-2 backdrop-blur-sm transition-transform hover:scale-105">
                    <span class="text-xl md:text-3xl font-bold text-white uppercase tracking-wide">LEADERBOARD</span>
                    <i class="fas fa-trophy text-xl text-brandYellow animate-float"></i>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content Wrapper -->
    <main class="flex-1 min-h-0 container mx-auto px-2 md:px-4 flex flex-col md:flex-row items-stretch justify-center gap-4 md:gap-8 pb-2 max-w-7xl relative z-10">
        
        <!-- Right Column: Podium (Top on Mobile) -->
        <div class="w-full md:w-[35%] shrink-0 flex items-end justify-center order-1 md:order-2 h-auto md:h-auto md:pb-8 md:sticky md:top-10">
            <div id="podium-container" class="flex items-end justify-center gap-2 md:gap-3 w-full h-full"></div>
        </div>

        <!-- Left Column: The List (Bottom on Mobile - Takes remaining height) -->
        <!-- Changed h-full to flex-1 to prevent overflow on mobile -->
        <div class="w-full md:w-[60%] flex flex-col flex-1 bg-[#0f111a]/80 rounded-t-2xl md:rounded-2xl border border-white/5 backdrop-blur-sm overflow-hidden shadow-2xl order-2 md:order-1 min-h-0">
            
            <!-- Search & Filter -->
            <div class="shrink-0 p-3 bg-[#111420] border-b border-[#1f2937]">
                <div class="relative mb-2">
                    <input type="text" id="search-input" placeholder="Search..." 
                        class="w-full bg-[#0a0e17] text-white placeholder-gray-500 rounded-lg px-4 py-2 pl-10 border border-[#334155] focus:outline-none focus:border-brandGreen focus:ring-1 focus:ring-brandGreen transition-all text-sm font-medium shadow-inner">
                    <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 text-sm"></i>
                    <button id="clear-search" onclick="clearSearch()" class="hidden absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white"><i class="fas fa-times"></i></button>
                </div>

                <div class="flex justify-between items-center px-1 text-[10px] font-bold text-gray-500 uppercase tracking-widest">
                    <span>Rankings</span>
                    <div class="flex items-center gap-2">
                        <span id="last-updated" class="font-mono hidden sm:block"></span>
                        <button onclick="loadData(true)" class="hover:text-white transition transform hover:rotate-180 duration-500" title="Refresh">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Scrollable List -->
            <div id="leaderboard-list" class="flex-1 overflow-y-auto custom-scroll px-3 py-2 space-y-2"></div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="w-full border-t border-[#1f2937] bg-[#05080f] py-3 z-20 shrink-0 hidden md:block">
        <div class="container mx-auto flex justify-between items-center px-6">
            <div class="text-left">
                <h3 class="text-base font-teko font-bold text-gray-300 tracking-wider uppercase">The Creator's Den</h3>
                <p class="text-gray-600 text-[10px]">Â© 2025.</p>
            </div>
            <div class="flex items-center gap-6">
                <a href="https://www.instagram.com/the.creators_den" target="_blank" class="transition-all duration-300 transform hover:scale-125 text-gray-400 hover:text-[#E1306C]">
                    <i class="fab fa-instagram text-3xl"></i>
                </a>
                <a href="https://chat.whatsapp.com/J9PtvxunychI8ifKUbPJkw" target="_blank" class="transition-all duration-300 transform hover:scale-125 text-gray-400 hover:text-[#25D366]">
                    <i class="fab fa-whatsapp text-3xl"></i>
                </a>
            </div>
        </div>
    </footer>

    <!-- PROFILE MODAL -->
    <div id="profile-modal" class="fixed inset-0 z-[10000] flex items-center justify-center bg-black/90 backdrop-blur-sm hidden" onclick="closeModal(event)">
        <div id="modal-content" class="bg-[#111625] border border-[#2d3748] rounded-2xl w-[95%] max-w-lg shadow-2xl relative overflow-hidden flex flex-col" onclick="event.stopPropagation()">
            
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-400 hover:text-white z-20 hover:rotate-90 transition duration-300 bg-black/40 rounded-full w-8 h-8 flex items-center justify-center"><i class="fas fa-times"></i></button>
            
            <!-- Header Section -->
            <div class="relative z-10 flex flex-col items-center pt-8 pb-6 bg-gradient-to-b from-[#1a2035] to-[#111625] border-b border-[#2d3748]">
                <div class="relative mb-3">
                    <div id="modal-avatar" class="w-24 h-24 rounded-full flex items-center justify-center text-4xl font-teko font-bold shadow-2xl border-4 border-[#111625] bg-[#1a2035] text-white"></div>
                    <!-- Badge Icon logic handled in JS -->
                    <div id="modal-badge-container" class="absolute -bottom-2 -right-2 hidden">
                         <!-- Injected via JS -->
                    </div>
                </div>

                <h2 id="modal-name" class="text-3xl font-teko font-bold uppercase tracking-wide text-white leading-none px-4 text-center"></h2>
                
                <div class="flex items-center gap-4 mt-3">
                    <span id="modal-rank" class="text-xs font-bold px-4 py-1 rounded-full border bg-black/20 tracking-wider text-gray-300 border-gray-600"></span>
                    <span id="modal-total" class="text-brandBlue font-mono font-bold text-xl"></span>
                </div>
            </div>

            <!-- History Section -->
            <div class="relative z-10 flex-grow bg-[#0d101b] p-2">
                <div class="text-[11px] uppercase tracking-[0.2em] text-gray-500 font-bold p-4 pb-2">History</div>
                <div id="modal-history" class="overflow-y-auto custom-scroll p-4 pt-0 space-y-3 max-h-[300px]"></div>
            </div>
        </div>
    </div>

    <script>
        const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRkTp9RMmnQeu5PkTka9qYw_9aBdFduLw2NYjVDKoO9dFp7515s3-i2VA715nxf7dYPVPhgMQqSaKKS/pub?output=csv'; 
        let allPlayers = [];
        let historyHeaders = [];
        let globalConfettiInstance = null;
        let winnerConfettiInstance = null;
        let displayCount = 50; 
        let currentPlayerForShare = null;

        window.onload = function() {
            const globalCanvas = document.getElementById('global-confetti-canvas');
            if (globalCanvas && window.confetti) globalConfettiInstance = confetti.create(globalCanvas, { resize: true, useWorker: true });
            
            const winnerCanvas = document.getElementById('winner-confetti-canvas');
            if (winnerCanvas && window.confetti) winnerConfettiInstance = confetti.create(winnerCanvas, { resize: true, useWorker: true });

            loadData();
        };
        
        function fireGlobalConfetti() {
            if (globalConfettiInstance) globalConfettiInstance({ particleCount: 120, spread: 100, origin: { y: 0.6 } });
        }

        function getInitials(name) {
            if (!name) return "?";
            const parts = name.trim().split(' ');
            if (parts.length === 1) return parts[0].substring(0, 2).toUpperCase();
            return (parts[0][0] + parts[parts.length - 1][0]).toUpperCase();
        }

        const searchInput = document.getElementById('search-input');
        const clearBtn = document.getElementById('clear-search');
        searchInput.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            clearBtn.classList.toggle('hidden', term === '');
            const filtered = allPlayers.filter(p => p.name.toLowerCase().includes(term));
            renderList(filtered, true); 
        });
        function clearSearch() {
            searchInput.value = '';
            clearBtn.classList.add('hidden');
            renderList(allPlayers.slice(0, displayCount), false); 
        }

        function openProfile(playerId) {
            const player = allPlayers.find(p => p.id === playerId);
            if (!player) return;
            currentPlayerForShare = player;

            const modal = document.getElementById('profile-modal');
            const avatar = document.getElementById('modal-avatar');
            const badgeContainer = document.getElementById('modal-badge-container');
            const name = document.getElementById('modal-name');
            const rank = document.getElementById('modal-rank');
            const total = document.getElementById('modal-total');
            const historyContainer = document.getElementById('modal-history');
            const winnerCanvas = document.getElementById('winner-confetti-canvas');

            let avatarClass = "text-gray-300 bg-[#334155] border-[#15192b]";
            badgeContainer.classList.add('hidden');
            badgeContainer.innerHTML = '';
            winnerCanvas.classList.add('hidden'); 

            if (player.rank === 1) {
                avatarClass = "text-brandYellow border-brandYellow/30 bg-brandYellow/10";
                badgeContainer.classList.remove('hidden');
                badgeContainer.innerHTML = `<div class="medal-gold w-8 h-8 rounded-full flex items-center justify-center shadow-lg"><i class="fas fa-trophy text-sm"></i></div>`;
            } else if (player.rank === 2) {
                avatarClass = "text-gray-200 border-gray-400/50 bg-white/5";
                badgeContainer.classList.remove('hidden');
                badgeContainer.innerHTML = `<div class="medal-silver w-8 h-8 rounded-full flex items-center justify-center shadow-lg font-bold text-sm">2</div>`;
            } else if (player.rank === 3) {
                avatarClass = "text-brandBlue border-brandBlue/30 bg-brandBlue/10";
                badgeContainer.classList.remove('hidden');
                badgeContainer.innerHTML = `<div class="medal-bronze w-8 h-8 rounded-full flex items-center justify-center shadow-lg font-bold text-sm">3</div>`;
            }

            avatar.className = `w-24 h-24 rounded-full flex items-center justify-center text-4xl font-teko font-bold shadow-2xl border-4 ${avatarClass}`;
            avatar.innerText = getInitials(player.name);
            
            name.innerText = player.name;
            rank.innerText = `RANK #${player.rank}`;
            rank.className = `text-[11px] font-bold px-3 py-1 rounded-full border tracking-wider ${player.rank === 1 ? 'border-brandYellow text-brandYellow bg-brandYellow/10' : 'border-gray-600 text-gray-400'}`;
            total.innerText = `${player.points.toLocaleString()} PTS`;

            historyContainer.innerHTML = '';
            if (player.history && player.history.length > 0) {
                player.history.forEach((score, idx) => {
                    const label = historyHeaders[idx] || `Quiz ${idx + 1}`;
                    const row = `
                        <div class="flex items-center justify-between p-4 rounded-xl bg-[#111625] border border-[#1f2937] hover:border-brandBlue/50 transition-colors">
                            <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">${label}</span>
                            <span class="font-mono font-bold text-white text-lg">${score}</span>
                        </div>
                    `;
                    historyContainer.insertAdjacentHTML('beforeend', row);
                });
            } else {
                historyContainer.innerHTML = '<div class="text-gray-600 text-xs text-center py-8">No history recorded.</div>';
            }

            modal.classList.remove('hidden');
            
            // FULL SCREEN CELEBRATION FOR WINNER
            if (player.rank === 1 && winnerConfettiInstance) {
                winnerCanvas.classList.remove('hidden'); 
                setTimeout(() => {
                    winnerConfettiInstance.reset();
                    winnerConfettiInstance({
                        particleCount: 200,
                        spread: 160,
                        origin: { y: 0.5 },
                        colors: ['#FFC20E', '#00AEEF', '#ED1C24'],
                        zIndex: 10001
                    });
                }, 150);
            }
        }

        function closeModal(e) {
            if (e && e.target.id !== 'profile-modal' && e.target.closest('#modal-content')) return;
            document.getElementById('profile-modal').classList.add('hidden');
            document.getElementById('winner-confetti-canvas').classList.add('hidden');
            if(winnerConfettiInstance) winnerConfettiInstance.reset();
        }

        async function loadData(manualRefresh = false) {
            const list = document.getElementById('leaderboard-list');
            if(manualRefresh) list.innerHTML = `<div class="text-center text-gray-500 mt-10 text-xs uppercase tracking-widest animate-pulse">Refreshing...</div>`;

            try {
                const url = manualRefresh ? `${SHEET_URL}&t=${new Date().getTime()}` : SHEET_URL;
                const res = await fetch(url);
                if (!res.ok) throw new Error("Sheet not found");
                const text = await res.text();
                const rows = text.split('\n').map(r => r.split(','));
                
                if (rows.length > 0) {
                    historyHeaders = rows[0].slice(2).map(h => h.replace(/"/g, '').trim());
                }

                const players = [];
                for (let i = 1; i < rows.length; i++) {
                    const col = rows[i];
                    if (col.length < 2) continue;
                    const name = col[0].replace(/"/g, '').trim();
                    let totalPts = 0;
                    const cleanTotal = col[1].replace(/"/g, '').trim();
                    if(cleanTotal !== "" && !isNaN(cleanTotal)) totalPts = parseInt(cleanTotal);
                    const history = [];
                    for(let j=2; j<col.length; j++) {
                        const val = col[j].replace(/"/g, '').trim();
                        if(val) history.push(val); 
                    }
                    if(name && name !== "Name" && !isNaN(totalPts)) {
                        players.push({ id: i, name: name, points: totalPts, history: history });
                    }
                }
                players.sort((a, b) => b.points - a.points);
                players.forEach((p, i) => p.rank = i + 1);
                allPlayers = players;
                renderList(players);
                renderPodium(players);
            } catch (err) {
                console.warn("Using Demo Data");
                const demoData = [
                    { id: 1, name: "Rehan Ali", points: 250, history: [50, 100, 100] },
                    { id: 2, name: "Sarah Smith", points: 230, history: [40, 90, 100] },
                    { id: 3, name: "John Doe", points: 210, history: [50, 80, 80] },
                    { id: 4, name: "Alice W", points: 190, history: [30, 80, 80] },
                    { id: 5, name: "Mike Ross", points: 170, history: [20, 70, 80] },
                ];
                demoData.forEach((p, i) => p.rank = i + 1);
                allPlayers = demoData;
                historyHeaders = ["Quiz 1", "Quiz 2", "Final"]; 
                renderList(demoData);
                renderPodium(demoData);
            }
        }

        function renderList(players, isSearch) {
            const list = document.getElementById('leaderboard-list');
            list.innerHTML = '';
            if(players.length === 0) { list.innerHTML = `<div class="text-center text-gray-500 text-xs mt-10">NO MATCHES FOUND</div>`; return; }
            
            players.forEach((p, idx) => {
                const rank = p.rank; 
                const initials = getInitials(p.name);
                
                // Shiny Medals for List
                let rankBadge = `<div class="w-8 h-8 flex items-center justify-center bg-[#1e2330] text-gray-500 font-bold rounded-full text-xs border border-[#334155] font-mono">${rank}</div>`;
                if(rank===1) rankBadge = `<div class="w-8 h-8 flex items-center justify-center medal-gold rounded-full font-bold text-sm"><i class="fas fa-trophy text-xs"></i></div>`;
                if(rank===2) rankBadge = `<div class="w-8 h-8 flex items-center justify-center medal-silver rounded-full font-bold text-sm">2</div>`;
                if(rank===3) rankBadge = `<div class="w-8 h-8 flex items-center justify-center medal-bronze rounded-full font-bold text-sm">3</div>`;

                const delay = idx * 0.05; 

                // ONE LINE LAYOUT
                const html = `
                <div class="pill-row mb-2 animate-[slideIn_0.4s_ease-out_forwards] group cursor-pointer" style="animation-delay: ${delay}s" onclick="openProfile(${p.id})">
                    
                    <!-- 1. RANK -->
                    <div class="w-10 flex justify-center shrink-0">
                        ${rankBadge}
                    </div>
                    
                    <!-- 2. AVATAR -->
                    <div class="w-12 flex justify-center shrink-0">
                        <div class="w-10 h-10 rounded-full bg-[#1e2330] flex items-center justify-center border-2 border-[#334155] text-white font-bold text-xs relative overflow-hidden uppercase">
                            ${initials}
                        </div>
                    </div>

                    <!-- 3. NAME -->
                    <div class="flex-grow pl-3 pr-2 min-w-0 flex flex-col justify-center">
                        <div class="text-[9px] text-gray-500 uppercase tracking-widest leading-none mb-0.5 font-bold">NAME</div>
                        <div class="text-sm font-bold uppercase truncate text-white leading-tight tracking-wide group-hover:text-brandGreen transition-colors duration-200">${p.name}</div>
                    </div>

                    <!-- 4. POINTS -->
                    <div class="text-right pr-2 shrink-0">
                         <div class="text-xl font-teko font-bold text-brandBlue leading-none group-hover:text-white transition-colors">${p.points}</div>
                         <div class="text-[9px] font-bold uppercase text-gray-500 tracking-widest leading-none">PTS</div>
                    </div>
                </div>`;
                list.insertAdjacentHTML('beforeend', html);
            });
        }

        function renderPodium(players) {
            const container = document.getElementById('podium-container');
            container.innerHTML = '';
            const top3 = [ players[1] || {name: "---", points: 0}, players[0] || {name: "---", points: 0}, players[2] || {name: "---", points: 0} ];
            
            const configs = [
                { rank: 2, color: 'bg-brandRed', height: 'h-24 md:h-44', border: 'border-[#b91c1c]', translate: 'translate-y-0', anim: 'float', delay: Math.random() * 2, badgeColor: 'bg-brandRed' }, 
                { rank: 1, color: 'bg-brandBlue', height: 'h-32 md:h-56', border: 'border-[#0077a3]', translate: '-translate-y-2 md:-translate-y-4', anim: 'float', delay: Math.random() * 2, badgeColor: 'bg-brandBlue' }, 
                { rank: 3, color: 'bg-brandYellow', height: 'h-16 md:h-32', border: 'border-[#b8860b]', translate: 'translate-y-0', anim: 'float', delay: Math.random() * 2, badgeColor: 'bg-brandYellow' }
            ];

            top3.forEach((p, i) => {
                const cfg = configs[i];
                const initials = getInitials(p.name);
                
                // Badges/Medals for Podium
                let badgeHTML = '';
                if (cfg.rank === 1) badgeHTML = '<div class="absolute -bottom-3 medal-gold text-xs font-bold w-7 h-7 flex items-center justify-center rounded-full z-20"><i class="fas fa-trophy"></i></div>';
                else if (cfg.rank === 2) badgeHTML = '<div class="absolute -bottom-3 medal-silver text-xs font-bold w-7 h-7 flex items-center justify-center rounded-full z-20">2</div>';
                else if (cfg.rank === 3) badgeHTML = '<div class="absolute -bottom-3 medal-bronze text-xs font-bold w-7 h-7 flex items-center justify-center rounded-full z-20">3</div>';

                const html = `
                <div class="flex flex-col items-center w-1/3 max-w-[140px] ${cfg.translate} cursor-pointer" onclick="openProfile(${p.id})">
                    <div style="animation: float 6s ease-in-out infinite; animation-delay: ${cfg.delay}s" class="w-full flex flex-col items-center">
                        ${cfg.rank === 1 ? `<div class="relative"><i class="fas fa-crown text-brandYellow text-2xl md:text-5xl mb-1 md:mb-2 drop-shadow-md"></i></div>` : ''}
                        
                        <div class="w-12 h-12 md:w-20 md:h-20 bg-[#15192b] rounded-full border-[3px] border-white flex items-center justify-center shadow-lg mb-2 md:mb-3 z-10 relative hover:scale-105 transition-transform">
                             <span class="text-sm md:text-2xl font-bold text-white">${initials}</span>
                             ${badgeHTML}
                        </div>

                        <div class="mb-1 md:mb-2 text-center relative z-0 w-full">
                            <div class="text-[9px] md:text-xs font-bold uppercase leading-tight px-1 truncate w-full text-white tracking-wide">${p.name}</div>
                            <div class="text-[8px] md:text-[10px] font-teko text-brandBlue tracking-widest bg-[#15192b] px-2 rounded mt-0.5 inline-block border border-[#334155]">${p.points} PTS</div>
                        </div>

                        <div class="w-full ${cfg.color} ${cfg.height} rounded-t-lg flex items-center justify-center shadow-lg border-b-0 border-x-0 border-t-4 ${cfg.border} relative overflow-hidden">
                            <!-- Visual Medal Icon on Bar -->
                            <i class="fas ${cfg.rank===1 ? 'fa-trophy' : 'fa-medal'} text-white/20 text-3xl md:text-5xl mt-2"></i>
                        </div>
                    </div>
                </div>`;
                container.insertAdjacentHTML('beforeend', html);
            });
        }
    </script>
</body>
</html>
